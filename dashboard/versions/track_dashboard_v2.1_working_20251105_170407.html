<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üèÅ GR Cup Coaching Dashboard v2.1</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0a0a0a;
            color: #ffffff;
            overflow-x: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #eb0a1e, #c41e3a);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }
        
        .header h1 {
            font-size: 1.8em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .session-info {
            text-align: right;
            font-size: 0.9em;
        }
        
        .main-container {
            display: grid;
            grid-template-columns: 300px 1fr 350px;
            grid-template-rows: 1fr 1fr;
            gap: 15px;
            padding: 15px;
            height: calc(100vh - 80px);
        }
        
        .panel {
            background: #1a1a1a;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            border: 1px solid #333;
            overflow-y: auto;
        }
        
        .panel h2 {
            color: #eb0a1e;
            margin-bottom: 15px;
            font-size: 1.2em;
            border-bottom: 2px solid #eb0a1e;
            padding-bottom: 8px;
        }
        
        .driver-list {
            grid-column: 1;
            grid-row: 1 / 3;
        }
        
        .performance-analysis {
            grid-column: 2;
            grid-row: 1;
        }
        
        .track-analysis {
            grid-column: 2;
            grid-row: 2;
        }
        
        .coaching-insights {
            grid-column: 3;
            grid-row: 1 / 3;
        }
        
        .driver-card {
            background: #2a2a2a;
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 4px solid #666;
        }
        
        .driver-card:hover {
            background: #333;
            transform: translateX(5px);
        }
        
        .driver-card.selected {
            border-left-color: #eb0a1e;
            background: #2a1a1a;
        }
        
        .driver-card.fast {
            border-left-color: #00ff00;
        }
        
        .driver-card.struggling {
            border-left-color: #ff6600;
        }
        
        .driver-card.needs-attention {
            border-left-color: #ff0000;
        }
        
        .driver-name {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 5px;
        }
        
        .driver-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            font-size: 0.85em;
        }
        
        .stat-item {
            display: flex;
            justify-content: space-between;
        }
        
        .performance-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .metric-card {
            background: #2a2a2a;
            padding: 15px;
            border-radius: 6px;
            text-align: center;
        }
        
        .metric-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #eb0a1e;
            margin-bottom: 5px;
        }
        
        .metric-label {
            font-size: 0.9em;
            opacity: 0.8;
        }
        
        .metric-trend {
            font-size: 0.8em;
            margin-top: 5px;
        }
        
        .trend-up { color: #00ff00; }
        .trend-down { color: #ff4444; }
        .trend-stable { color: #ffaa00; }
        
        .sector-analysis {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
            margin: 15px 0;
        }
        
        .sector {
            background: #2a2a2a;
            padding: 10px;
            border-radius: 4px;
            text-align: center;
            font-size: 0.85em;
        }
        
        .sector.best { background: #1a4a1a; }
        .sector.worst { background: #4a1a1a; }
        .sector.average { background: #2a2a2a; }
        
        .coaching-card {
            background: #2a2a2a;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #eb0a1e;
        }
        
        .coaching-card.critical {
            border-left-color: #ff0000;
            background: #3a1a1a;
        }
        
        .coaching-card.improvement {
            border-left-color: #ffaa00;
            background: #3a2a1a;
        }
        
        .coaching-card.positive {
            border-left-color: #00ff00;
            background: #1a3a1a;
        }
        
        .coaching-title {
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 1em;
        }
        
        .coaching-detail {
            font-size: 0.9em;
            line-height: 1.4;
            opacity: 0.9;
        }
        
        .track-container {
            width: 100%;
            height: 200px;
            background: #0a0a0a;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            position: relative;
        }
        
        .track-image {
            max-width: 100%;
            max-height: 100%;
            border-radius: 6px;
            object-fit: contain;
        }
        
        .track-selector {
            margin-bottom: 15px;
        }
        
        .track-selector select {
            background: #2a2a2a;
            color: white;
            border: 1px solid #eb0a1e;
            padding: 8px;
            border-radius: 4px;
            font-size: 0.9em;
            width: 100%;
        }
        
        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 6px;
        }
        
        .status-live {
            background: #00ff00;
            animation: pulse 2s infinite;
        }
        
        .status-warning {
            background: #ffaa00;
        }
        
        .status-critical {
            background: #ff0000;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .comparison-chart {
            background: #2a2a2a;
            border-radius: 6px;
            padding: 15px;
            margin-top: 15px;
        }
        
        .chart-bar {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .chart-label {
            width: 80px;
            font-size: 0.8em;
        }
        
        .chart-bar-fill {
            height: 20px;
            background: #eb0a1e;
            border-radius: 2px;
            margin-right: 8px;
        }
        
        .chart-value {
            font-size: 0.8em;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <div>
            <h1>üèÅ GR Cup Coaching Dashboard</h1>
            <div style="font-size: 0.8em; opacity: 0.8;">Version 2.1 - Performance Analysis & Coaching</div>
        </div>
        <div class="session-info">
            <div><strong>Session:</strong> Practice 2</div>
            <div><strong>Track:</strong> <span id="currentTrackName">Barber Motorsports Park</span></div>
            <div><strong>Time:</strong> <span id="sessionTime">45:23</span></div>
        </div>
    </div>
    
    <div class="main-container">
        <!-- Driver List Panel -->
        <div class="panel driver-list">
            <h2>üèéÔ∏è Driver Performance</h2>
            <div id="driverList">
                <!-- Drivers will be populated here -->
            </div>
        </div>
        
        <!-- Performance Analysis Panel -->
        <div class="panel performance-analysis">
            <h2>üìä Performance Analysis</h2>
            <div id="performanceContent">
                <p>Select a driver to view detailed performance metrics</p>
            </div>
        </div>
        
        <!-- Track Analysis Panel -->
        <div class="panel track-analysis">
            <h2>üó∫Ô∏è Track Analysis</h2>
            <div id="trackContent">
                <div class="track-selector">
                    <select id="trackSelector">
                        <option value="BMP">Barber Motorsports Park</option>
                        <option value="COTA">Circuit of the Americas</option>
                        <option value="VIR">Virginia International Raceway</option>
                        <option value="SEB">Sebring International Raceway</option>
                        <option value="SON">Sonoma Raceway</option>
                        <option value="RA">Road America</option>
                        <option value="INDY">Indianapolis Motor Speedway</option>
                    </select>
                </div>
                
                <div class="track-container">
                    <img id="trackImage" class="track-image" src="" alt="Track Layout" />
                </div>
                
                <div style="background: #2a2a2a; padding: 12px; border-radius: 6px;">
                    <h4 style="color: #eb0a1e; margin-bottom: 8px;">Track Coaching Notes</h4>
                    <div id="trackInsights" style="font-size: 0.9em; line-height: 1.4;">
                        Focus on smooth inputs through the technical sections. Turn 5 is crucial for lap time.
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Coaching Insights Panel -->
        <div class="panel coaching-insights">
            <h2>üéØ Coaching Insights</h2>
            <div id="coachingContent">
                <p>Select a driver to view coaching recommendations</p>
            </div>
        </div>
    </div>
    
    <script src="track_images_embedded.js"></script>
    <script>
        // Driver data with realistic performance metrics and coaching insights
        const driverData = {
            "042": {
                name: "Driver #042",
                chassis: "GR86-001-042",
                bestLap: "1:24.567",
                avgSpeed: 142.3,
                consistency: 94,
                position: 3,
                status: "fast",
                sectors: [23.456, 31.234, 29.877, 25.123, 28.456, 26.421],
                strengths: ["Consistent braking points", "Good sector 3 times", "Smooth throttle application"],
                weaknesses: ["Losing 0.3s in sector 2", "Late on throttle in tight corners"],
                recommendations: [
                    "Work on corner exit technique in turns 5-7",
                    "Focus on sector 2 optimization - try later braking point",
                    "Practice trail braking to improve corner entry speed"
                ]
            },
            "018": {
                name: "Driver #018", 
                chassis: "GR86-001-018",
                bestLap: "1:23.234",
                avgSpeed: 145.7,
                consistency: 97,
                position: 1,
                status: "fast",
                sectors: [22.987, 30.456, 29.234, 24.789, 27.987, 25.781],
                strengths: ["Excellent consistency", "Strong sector 1 & 4", "Perfect racing line"],
                weaknesses: ["Minor time loss in sector 6"],
                recommendations: [
                    "Maintain current pace and consistency",
                    "Fine-tune sector 6 approach for extra 0.1s",
                    "Focus on race strategy and tire management"
                ]
            },
            "073": {
                name: "Driver #073",
                chassis: "GR86-001-073", 
                bestLap: "1:26.123",
                avgSpeed: 138.9,
                consistency: 87,
                position: 8,
                status: "struggling",
                sectors: [24.123, 32.456, 31.234, 26.789, 29.876, 27.645],
                strengths: ["Good sector 1 entry speed"],
                weaknesses: ["Inconsistent sector 2 & 3", "Struggling with tire management", "Overdriving in corners"],
                recommendations: [
                    "Focus on smooth inputs - reduce aggression",
                    "Work on racecraft fundamentals",
                    "Tire pressure adjustment needed (+2 PSI front)",
                    "Practice consistent braking points"
                ]
            },
            "091": {
                name: "Driver #091",
                chassis: "GR86-001-091",
                bestLap: "1:25.789", 
                avgSpeed: 140.2,
                consistency: 91,
                position: 5,
                status: "needs-attention",
                sectors: [23.789, 31.876, 30.123, 25.456, 28.789, 26.756],
                strengths: ["Strong sector 1 & 4 performance", "Good straight-line speed"],
                weaknesses: ["Losing significant time in sector 3", "Inconsistent corner exit"],
                recommendations: [
                    "Chassis setup review needed - check rear wing angle",
                    "Focus on sector 3 technique - turns 8-10 critical",
                    "Consider different racing line through chicane",
                    "Work on throttle application timing"
                ]
            }
        };
        
        // Track configurations with detailed coaching insights
        const trackConfigs = {
            'BMP': { 
                name: 'Barber Motorsports Park', 
                insights: "Technical track requiring smooth inputs. Turn 5 is crucial - late apex and early throttle. Watch tire degradation on abrasive surface. Focus on maintaining momentum through the flowing sections."
            },
            'COTA': { 
                name: 'Circuit of the Americas', 
                insights: "Turn 1 is key for overtaking. Commit through the esses in sector 2. Manage tire temperatures in technical middle sector. Elevation changes affect braking points."
            },
            'VIR': { 
                name: 'Virginia International Raceway', 
                insights: "High-speed track requiring aerodynamic efficiency. The uphill esses demand precise car control. Focus on maintaining momentum through flowing sections."
            },
            'SEB': { 
                name: 'Sebring International Raceway', 
                insights: "Bumpy surface requires suspension setup focus. Turn 17 hairpin is critical for lap time. Manage tire wear on the abrasive concrete sections."
            },
            'SON': { 
                name: 'Sonoma Raceway', 
                insights: "Elevation changes affect braking points. Turn 2 and the carousel are lap time critical. Focus on late braking and trail braking technique."
            },
            'RA': { 
                name: 'Road America', 
                insights: "High-speed track with long straights. Aerodynamic efficiency crucial. The kink requires commitment. Focus on exit speed from slow corners."
            },
            'INDY': { 
                name: 'Indianapolis Motor Speedway', 
                insights: "Oval racing requires different techniques. Focus on car balance and tire management. Draft strategy is crucial for competitive positioning."
            }
        };
        
        let selectedDriver = "042";
        let currentTrack = "BMP";
        
        function initializeDashboard() {
            console.log("Initializing GR Cup Coaching Dashboard v2.1");
            populateDriverList();
            updatePerformanceAnalysis(selectedDriver);
            updateTrackDisplay(currentTrack);
            generateCoachingInsights(selectedDriver);
            
            // Set up event listeners
            document.getElementById('trackSelector').addEventListener('change', function() {
                currentTrack = this.value;
                updateTrackDisplay(currentTrack);
                generateCoachingInsights(selectedDriver);
            });
            
            startRealTimeUpdates();
        }
        
        function populateDriverList() {
            const driverList = document.getElementById('driverList');
            driverList.innerHTML = '';
            
            Object.entries(driverData).forEach(([driverId, driver]) => {
                const driverCard = document.createElement('div');
                driverCard.className = `driver-card ${driver.status}`;
                if (driverId === selectedDriver) driverCard.classList.add('selected');
                
                driverCard.innerHTML = `
                    <div class="driver-name">
                        <span class="status-indicator status-${driver.status === 'fast' ? 'live' : driver.status === 'struggling' ? 'critical' : 'warning'}"></span>
                        ${driver.name}
                    </div>
                    <div class="driver-stats">
                        <div class="stat-item">
                            <span>Position:</span>
                            <span>P${driver.position}</span>
                        </div>
                        <div class="stat-item">
                            <span>Best Lap:</span>
                            <span>${driver.bestLap}</span>
                        </div>
                        <div class="stat-item">
                            <span>Avg Speed:</span>
                            <span>${driver.avgSpeed} mph</span>
                        </div>
                        <div class="stat-item">
                            <span>Consistency:</span>
                            <span>${driver.consistency}%</span>
                        </div>
                    </div>
                `;
                
                driverCard.addEventListener('click', () => {
                    selectedDriver = driverId;
                    populateDriverList();
                    updatePerformanceAnalysis(driverId);
                    generateCoachingInsights(driverId);
                });
                
                driverList.appendChild(driverCard);
            });
        }
        
        function updatePerformanceAnalysis(driverId) {
            const driver = driverData[driverId];
            const performanceContent = document.getElementById('performanceContent');
            
            performanceContent.innerHTML = `
                <h3 style="color: #eb0a1e; margin-bottom: 15px;">${driver.name} - Chassis ${driver.chassis}</h3>
                
                <div class="performance-grid">
                    <div class="metric-card">
                        <div class="metric-value">${driver.bestLap}</div>
                        <div class="metric-label">Best Lap Time</div>
                        <div class="metric-trend trend-down">‚Üì 0.234s faster</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">${driver.avgSpeed}</div>
                        <div class="metric-label">Avg Speed (mph)</div>
                        <div class="metric-trend trend-up">‚Üë 2.1 mph</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">${driver.consistency}%</div>
                        <div class="metric-label">Consistency</div>
                        <div class="metric-trend trend-stable">‚Üí Stable</div>
                    </div>
                </div>
                
                <h4 style="color: #eb0a1e; margin-bottom: 10px;">Sector Analysis</h4>
                <div class="sector-analysis">
                    ${generateSectorAnalysis(driver.sectors)}
                </div>
                
                <div class="comparison-chart">
                    <h4 style="color: #eb0a1e; margin-bottom: 10px;">vs. Session Leader (#018)</h4>
                    ${generateComparisonChart(driver)}
                </div>
            `;
        }
        
        function generateSectorAnalysis(sectors) {
            const bestSector = Math.min(...sectors);
            const worstSector = Math.max(...sectors);
            
            return sectors.map((time, index) => {
                let sectorClass = 'average';
                if (time === bestSector) sectorClass = 'best';
                else if (time === worstSector) sectorClass = 'worst';
                
                return `
                    <div class="sector ${sectorClass}">
                        <div>S${index + 1}</div>
                        <div>${time.toFixed(3)}s</div>
                    </div>
                `;
            }).join('');
        }
        
        function generateComparisonChart(driver) {
            const leader = driverData["018"];
            return driver.sectors.map((time, index) => {
                const delta = time - leader.sectors[index];
                const percentage = Math.min(100, Math.abs(delta) * 50);
                
                return `
                    <div class="chart-bar">
                        <div class="chart-label">S${index + 1}</div>
                        <div class="chart-bar-fill" style="width: ${percentage}%; background: ${delta > 0 ? '#ff4444' : '#44ff44'}"></div>
                        <div class="chart-value">${delta > 0 ? '+' : ''}${delta.toFixed(3)}s</div>
                    </div>
                `;
            }).join('');
        }
        
        function updateTrackDisplay(trackId) {
            const config = trackConfigs[trackId];
            const trackImage = document.getElementById('trackImage');
            
            document.getElementById('currentTrackName').textContent = config.name;
            document.getElementById('trackInsights').textContent = config.insights;
            
            // Update track selector
            document.getElementById('trackSelector').value = trackId;
            
            // Load track image
            if (typeof TRACK_IMAGES !== 'undefined' && TRACK_IMAGES[trackId]) {
                trackImage.src = TRACK_IMAGES[trackId].image_url;
                trackImage.alt = `${config.name} Track Layout`;
            } else {
                // Fallback SVG
                const trackContainer = document.querySelector('.track-container');
                trackContainer.innerHTML = `
                    <svg width="100%" height="100%" viewBox="0 0 300 200" style="background: #0a0a0a;">
                        <ellipse cx="150" cy="100" rx="120" ry="80" 
                                 fill="none" stroke="#eb0a1e" stroke-width="2"/>
                        <circle cx="150" cy="20" r="3" fill="#00ff00"/>
                        <text x="150" y="100" text-anchor="middle" fill="white" font-size="12">
                            ${config.name}
                        </text>
                    </svg>
                `;
            }
        }
        
        function generateCoachingInsights(driverId) {
            const driver = driverData[driverId];
            const coachingContent = document.getElementById('coachingContent');
            
            let insights = '';
            
            // Critical issues for struggling drivers
            if (driver.status === 'needs-attention' || driver.status === 'struggling') {
                insights += `
                    <div class="coaching-card critical">
                        <div class="coaching-title">üö® Critical Issues</div>
                        <div class="coaching-detail">
                            ${driver.weaknesses.join('. ')}. Immediate attention required.
                        </div>
                    </div>
                `;
            }
            
            // Specific recommendations
            insights += `
                <div class="coaching-card improvement">
                    <div class="coaching-title">üí° Coaching Recommendations</div>
                    <div class="coaching-detail">
                        ${driver.recommendations.map(rec => `‚Ä¢ ${rec}`).join('<br>')}
                    </div>
                </div>
            `;
            
            // Strengths to maintain
            insights += `
                <div class="coaching-card positive">
                    <div class="coaching-title">‚úÖ Strengths to Maintain</div>
                    <div class="coaching-detail">
                        ${driver.strengths.map(str => `‚Ä¢ ${str}`).join('<br>')}
                    </div>
                </div>
            `;
            
            // Chassis-specific insights
            insights += `
                <div class="coaching-card">
                    <div class="coaching-title">üîß Chassis Setup Notes</div>
                    <div class="coaching-detail">
                        Chassis: ${driver.chassis}<br>
                        ${getChassisRecommendations(driver)}
                    </div>
                </div>
            `;
            
            // Track-specific coaching
            insights += `
                <div class="coaching-card">
                    <div class="coaching-title">üèÅ Track-Specific Coaching</div>
                    <div class="coaching-detail">
                        ${getTrackSpecificCoaching(driver, currentTrack)}
                    </div>
                </div>
            `;
            
            coachingContent.innerHTML = insights;
        }
        
        function getChassisRecommendations(driver) {
            if (driver.consistency < 90) {
                return "Consider softer suspension settings for better predictability. Check tire pressures - may be contributing to inconsistency.";
            } else if (driver.avgSpeed < 140) {
                return "Aerodynamic package may need adjustment. Consider lower downforce setup for better straight-line speed.";
            } else {
                return "Chassis balance looks good. Fine-tune differential settings for optimal corner exit.";
            }
        }
        
        function getTrackSpecificCoaching(driver, trackId) {
            const trackAdvice = {
                'BMP': "Focus on smooth inputs through technical sections. Turn 5 late apex crucial for lap time.",
                'COTA': "Commit through the esses in sector 2. Turn 1 positioning critical for race strategy.",
                'VIR': "Maintain momentum through flowing sections. Uphill esses require precise car control.",
                'SEB': "Adjust for bumpy surface. Turn 17 hairpin is lap time critical.",
                'SON': "Elevation changes affect braking points. Focus on trail braking technique.",
                'RA': "High-speed track - aerodynamic efficiency crucial. Commit through the kink.",
                'INDY': "Oval techniques required. Focus on car balance and tire management."
            };
            
            return trackAdvice[trackId] || "Focus on fundamentals and smooth driving technique.";
        }
        
        function startRealTimeUpdates() {
            setInterval(() => {
                // Update session time
                const sessionTime = document.getElementById('sessionTime');
                const currentTime = sessionTime.textContent.split(':');
                let minutes = parseInt(currentTime[0]);
                let seconds = parseInt(currentTime[1]);
                
                seconds++;
                if (seconds >= 60) {
                    seconds = 0;
                    minutes++;
                }
                
                sessionTime.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                // Simulate minor performance changes
                if (Math.random() < 0.2) {
                    Object.keys(driverData).forEach(driverId => {
                        const driver = driverData[driverId];
                        driver.avgSpeed += (Math.random() - 0.5) * 0.3;
                        driver.consistency += (Math.random() - 0.5) * 0.2;
                        
                        // Keep values in realistic ranges
                        driver.avgSpeed = Math.max(130, Math.min(150, driver.avgSpeed));
                        driver.consistency = Math.max(80, Math.min(100, driver.consistency));
                    });
                    
                    populateDriverList();
                    if (selectedDriver) {
                        updatePerformanceAnalysis(selectedDriver);
                    }
                }
            }, 2000);
        }
        
        // Initialize dashboard when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log("DOM loaded, initializing dashboard...");
            initializeDashboard();
        });
    </script>
</body>
</html>